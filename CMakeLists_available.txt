# OpenCog Unified - Optimized for Available Components
cmake_minimum_required(VERSION 3.10)
project(opencog-unified VERSION 1.0.0)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Module path setup
set(CMAKE_MODULE_PATH
    ${CMAKE_CURRENT_SOURCE_DIR}/cmake
    ${CMAKE_CURRENT_SOURCE_DIR}/cogutil/cmake
    ${CMAKE_MODULE_PATH}
)

# Dependency-optimized build sequence

# Level 0 - Parallel builds: cogutil
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/cogutil/CMakeLists.txt")
    add_subdirectory(cogutil)
endif()

# Level 1 - Parallel builds: atomspace, moses, language_learning
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/atomspace/CMakeLists.txt")
    add_subdirectory(atomspace)
endif()
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/moses/CMakeLists.txt")
    add_subdirectory(moses)
endif()
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/language-learning/CMakeLists.txt")
    add_subdirectory(language-learning)
endif()

# Level 2 - Parallel builds: atomspace_storage, unify, spacetime, lg_atomese
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/atomspace-storage/CMakeLists.txt")
    add_subdirectory(atomspace-storage)
endif()
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/unify/CMakeLists.txt")
    add_subdirectory(unify)
endif()
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/spacetime/CMakeLists.txt")
    add_subdirectory(spacetime)
endif()
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/lg-atomese/CMakeLists.txt")
    add_subdirectory(lg-atomese)
endif()

# Level 3 - Parallel builds: cogserver, atomspace_rocks
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/cogserver/CMakeLists.txt")
    add_subdirectory(cogserver)
endif()
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/atomspace-rocks/CMakeLists.txt")
    add_subdirectory(atomspace-rocks)
endif()

# Level 4 - Parallel builds: atomspace_restful, ure, attention, learn
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/atomspace-restful/CMakeLists.txt")
    add_subdirectory(atomspace-restful)
endif()
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/ure/CMakeLists.txt")
    add_subdirectory(ure)
endif()
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/attention/CMakeLists.txt")
    add_subdirectory(attention)
endif()
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/learn/CMakeLists.txt")
    add_subdirectory(learn)
endif()

# Level 5 - Parallel builds: pln, miner, asmoses
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/pln/CMakeLists.txt")
    add_subdirectory(pln)
endif()
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/miner/CMakeLists.txt")
    add_subdirectory(miner)
endif()
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/asmoses/CMakeLists.txt")
    add_subdirectory(asmoses)
endif()

# Level 6 - Parallel builds: opencog
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/opencog/CMakeLists.txt")
    add_subdirectory(opencog)
endif()

# Explicit dependency relationships for available components
if(TARGET moses AND TARGET cogutil)
    add_dependencies(moses cogutil)
endif()
if(TARGET miner AND TARGET cogutil)
    add_dependencies(miner cogutil)
endif()
if(TARGET miner AND TARGET ure)
    add_dependencies(miner ure)
endif()
if(TARGET miner AND TARGET unify)
    add_dependencies(miner unify)
endif()
if(TARGET miner AND TARGET atomspace)
    add_dependencies(miner atomspace)
endif()
if(TARGET lg-atomese AND TARGET cogutil)
    add_dependencies(lg-atomese cogutil)
endif()
if(TARGET lg-atomese AND TARGET atomspace)
    add_dependencies(lg-atomese atomspace)
endif()
if(TARGET learn AND TARGET cogserver)
    add_dependencies(learn cogserver)
endif()
if(TARGET learn AND TARGET cogutil)
    add_dependencies(learn cogutil)
endif()
if(TARGET learn AND TARGET unify)
    add_dependencies(learn unify)
endif()
if(TARGET learn AND TARGET atomspace)
    add_dependencies(learn atomspace)
endif()
if(TARGET atomspace-rocks AND TARGET cogutil)
    add_dependencies(atomspace-rocks cogutil)
endif()
if(TARGET atomspace-rocks AND TARGET atomspace-storage)
    add_dependencies(atomspace-rocks atomspace-storage)
endif()
if(TARGET atomspace-rocks AND TARGET atomspace)
    add_dependencies(atomspace-rocks atomspace)
endif()
if(TARGET ure AND TARGET cogserver)
    add_dependencies(ure cogserver)
endif()
if(TARGET ure AND TARGET cogutil)
    add_dependencies(ure cogutil)
endif()
if(TARGET ure AND TARGET unify)
    add_dependencies(ure unify)
endif()
if(TARGET ure AND TARGET atomspace)
    add_dependencies(ure atomspace)
endif()
if(TARGET asmoses AND TARGET cogutil)
    add_dependencies(asmoses cogutil)
endif()
if(TARGET asmoses AND TARGET ure)
    add_dependencies(asmoses ure)
endif()
if(TARGET asmoses AND TARGET atomspace)
    add_dependencies(asmoses atomspace)
endif()
if(TARGET attention AND TARGET cogserver)
    add_dependencies(attention cogserver)
endif()
if(TARGET attention AND TARGET cogutil)
    add_dependencies(attention cogutil)
endif()
if(TARGET attention AND TARGET atomspace)
    add_dependencies(attention atomspace)
endif()
if(TARGET cogserver AND TARGET cogutil)
    add_dependencies(cogserver cogutil)
endif()
if(TARGET cogserver AND TARGET atomspace-storage)
    add_dependencies(cogserver atomspace-storage)
endif()
if(TARGET cogserver AND TARGET atomspace)
    add_dependencies(cogserver atomspace)
endif()
if(TARGET atomspace AND TARGET cogutil)
    add_dependencies(atomspace cogutil)
endif()
if(TARGET opencog AND TARGET cogserver)
    add_dependencies(opencog cogserver)
endif()
if(TARGET opencog AND TARGET lg-atomese)
    add_dependencies(opencog lg-atomese)
endif()
if(TARGET opencog AND TARGET cogutil)
    add_dependencies(opencog cogutil)
endif()
if(TARGET opencog AND TARGET ure)
    add_dependencies(opencog ure)
endif()
if(TARGET opencog AND TARGET pln)
    add_dependencies(opencog pln)
endif()
if(TARGET opencog AND TARGET attention)
    add_dependencies(opencog attention)
endif()
if(TARGET opencog AND TARGET atomspace)
    add_dependencies(opencog atomspace)
endif()
if(TARGET atomspace-restful AND TARGET cogserver)
    add_dependencies(atomspace-restful cogserver)
endif()
if(TARGET atomspace-restful AND TARGET cogutil)
    add_dependencies(atomspace-restful cogutil)
endif()
if(TARGET atomspace-restful AND TARGET atomspace)
    add_dependencies(atomspace-restful atomspace)
endif()
if(TARGET pln AND TARGET spacetime)
    add_dependencies(pln spacetime)
endif()
if(TARGET pln AND TARGET cogutil)
    add_dependencies(pln cogutil)
endif()
if(TARGET pln AND TARGET ure)
    add_dependencies(pln ure)
endif()
if(TARGET pln AND TARGET unify)
    add_dependencies(pln unify)
endif()
if(TARGET pln AND TARGET atomspace)
    add_dependencies(pln atomspace)
endif()
if(TARGET language-learning AND TARGET cogutil)
    add_dependencies(language-learning cogutil)
endif()
if(TARGET unify AND TARGET cogutil)
    add_dependencies(unify cogutil)
endif()
if(TARGET unify AND TARGET atomspace)
    add_dependencies(unify atomspace)
endif()
if(TARGET atomspace-storage AND TARGET cogutil)
    add_dependencies(atomspace-storage cogutil)
endif()
if(TARGET atomspace-storage AND TARGET atomspace)
    add_dependencies(atomspace-storage atomspace)
endif()
if(TARGET spacetime AND TARGET cogutil)
    add_dependencies(spacetime cogutil)
endif()
if(TARGET spacetime AND TARGET atomspace)
    add_dependencies(spacetime atomspace)
endif()